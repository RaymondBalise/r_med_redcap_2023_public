<!DOCTYPE html>
<html lang="" xml:lang="">
  <head>
    <title>Using REDCap and R to Rapidly Produce Biomedical Publications</title>
    <meta charset="utf-8" />
    <meta name="author" content="Raymond Balise with Anna Calderon, Belén Hervera, Tyler Bartholomew, Stephan Kadauke, João Pedro Carmezim Correia, and Will Beasley" />
    <meta name="date" content="2023-05-30" />
    <script src="libs/header-attrs-2.21/header-attrs.js"></script>
    <link href="libs/remark-css-0.0.1/default.css" rel="stylesheet" />
    <link href="libs/tile-view-0.2.6/tile-view.css" rel="stylesheet" />
    <script src="libs/tile-view-0.2.6/tile-view.js"></script>
    <script src="libs/kePrint-0.0.1/kePrint.js"></script>
    <link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet" />
    <link rel="stylesheet" href="assets/sydney.css" type="text/css" />
    <link rel="stylesheet" href="assets/cssninja-scaffold.css" type="text/css" />
    <link rel="stylesheet" href="assets/ninjutsu.css" type="text/css" />
  </head>
  <body>
    <textarea id="source">
class: center, middle, inverse, title-slide

.title[
# Using REDCap and R to Rapidly Produce Biomedical Publications
]
.subtitle[
## 02 - Example
]
.author[
### Raymond Balise with Anna Calderon, Belén Hervera, Tyler Bartholomew, Stephan Kadauke, João Pedro Carmezim Correia, and Will Beasley
]
.date[
### May 30, 2023
]

---









class: segue

Infectious Disease Elimination Act

---
# Intersecting Epidemics

+ HIV
+ hepatitis C
+ overdose deaths

---
.pull-left[![:scale 80%](images/02_examples/hiv.jpg)

![:scale 80%](images/02_examples/AIDSVu_fl.jpg)
]


.pull-right[![:scale 100%](images/02_examples/hep.jpg)]

???
downloaded 2023-03-03
https://map.aidsvu.org/map
https://www.cdc.gov/hepatitis/statistics/2018surveillance/HepC.htm 

---

.center[
![:scale 70%](images/02_examples/overdose.jpg)
]

---

.center[
![:scale 70%](images/02_examples/counts.jpg)
]

---
# Harm Reduction

.center[
https://www.youtube.com/watch?v=ldTxMIblePk

&lt;iframe src="https://www.youtube.com/embed/ldTxMIblePk" title="One Doctor’s Needle Fix" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share"  allowfullscreen&gt;&lt;/iframe&gt;
]

---
# NIDA Videos


.center[
Addressing Barriers to Care

https://www.youtube.com/watch?v=2d_3DqMEdEg

What is Harm Reduction?

https://www.youtube.com/watch?v=ikmKxgCTXFA


Caring for People Who Use Drugs

https://www.youtube.com/watch?v=7RI72zvO2dU

]

---
# IDEA Syringe Services Program

+ The Infectious Disease Elimination Act (IDEA) of 2016 was signed into law on July 1, 2016.
+ This policy authorized the University of Miami to open the .red[first] legal syringe services program (or .red[needle exchange]) in the state of .red[Florida]
    + decriminalized possession and distribution of syringes for those engaged in the program
    + 5-year, unfunded pilot project, set to end in July, 2021

+ Prior to implementation, REDCap was used to build a data collection system to evaluate the pilot program with the sole purpose of .red[providing data to the legislature] to enhance advocacy efforts for statewide expansion of the program.

---
class: segue

Infectious Disease Elimination Act - REDCap

---
# Current Database

+ More than 2100 people have been helped.
+ Lessons Learned
   + Fixed vs. mobile sites had similar but not identical variables.
   + Services variables were added.
   + Questions were added and some dropped.
   + Not all variables were validated.
+ Using new features in REDCap
   
   
---
# New Version for the Other Sites

.pull-left[
+ a .red[single, fixed/mobile] project for each county
+ .red[Multiple instruments] in the project
+ follows `tidyverse` naming convention
+ removes .red[dropped content]
+ .red[Validation] on all text
+ numeric .red[calculated fields] 
  + for needle supply by size
+ .red[Calculated text] and hidden fields using action tags
]
.pull-right[
+ .red[Automatic alerts] for testing (HIV/Hep C)
  + referrals (smart variables for latest info)
+ added .red[supply tracking] (not shown here)
+ greatly improved .red[aesthetics] &amp; .red[organization]
    + Custom HTML/CSS
    + Field embedding
+ .red[Data Access Groups] for locations in a county
]
    
---
# Show and Tell - Designer

![:scale 100%](images/02_examples/idea_designer.jpg)

---
# Show and Tell - Repeated

![:scale 100%](images/02_examples/idea_repeated.jpg)

---
# Show and Tell - Add Typical

![:scale 100%](images/02_examples/idea_add.jpg)


---
# Show and Tell - Add

![:scale 100%](images/02_examples/idea_add1.jpg)


---
# Show and Tell - Enrollment

.scroll-box-18[
![:scale 100%](images/02_examples/idea_record.jpg)
]

---
# Show and Tell - Enrollment

.scroll-box-18[
.center[
![:scale 100%](images/02_examples/idea_intake.jpg)
]
]


---
# Show and Tell - Daily

.scroll-box-18[
.center[
![:scale 100%](images/02_examples/idea_daily.jpg)
]]

---
# Show and Tell - Naloxone

.scroll-box-18[
.center[
![:scale 100%](images/02_examples/naloxone.gif)
]]

---
# Before and After Field Embedding

.pull-left[
.scroll-box-16[
![:scale 100%](images/02_examples/embedding_before.jpg)
]
]
.pull-right[
![:scale 100%](images/02_examples/embedding_after.jpg)
]

---
# Field Embedding with Branching Logic

* Add all the fields that may appear.
* Add a Descriptive Text field.
* Design the appearance with *What You See Is What You Get* (WYSIWYG) tools. 
    + *Rich Text Editor* controls for text and drawing grids
    + Embed variables in the grid with `{thingy}` references

---
# Field Embedding with Branching Logic

.scroll-box-18[
.center[
![:scale 100%](images/02_examples/idea_embedding.jpg)
]]

---
# WYSIWYG - Pretty Data Collection

.scroll-box-18[
.center[
![:scale 100%](images/02_examples/idea_grid.jpg)
]]

---
class: segue

Integrating with R


---
# `rUM`

+ I teach in a medical school (i.e., smart people who are not programmers).
+ I teach `r` at `UM`, so to support my students, I give them .blue[`rUM`].
+ It has menu-driven tools to add `R Markdown` code or to add complete projects.
+ The projects contain:
    + Quarto or R Markdown paper shells for manuscripts
        + full-featured YAML header
        + code to add used packages to the paper bibliography
    + an aggressive .gitignore file
    + a data folder
    
---
# rUM Uses Posit's Brilliance

+ .blue[`rUM`] uses the Quarto and R Markdown magic that Yihui Xie and his colleagues at Posit/RStudio and around the world have created.

.center[
&lt;https://quarto.org/&gt;
]

.pull-left[
.center[
![:scale 40%](images/02_examples/cover_guide.png)
&lt;br/&gt;
[R Markdown: The Definitive Guide](https://bookdown.org/yihui/rmarkdown/)
]]
.pull-right[
.center[
![:scale 40%](images/02_examples/cover_cookbook.png)
&lt;br/&gt;
[R Markdown Cookbook](https://bookdown.org/yihui/rmarkdown-cookbook/)  
]]

---
# Using .blue[`rUM`]  

+ Install with .blue[`remotes::install_cran("rUM")`] or .blue[`install.packages("rUM")`].
+ Completely stop and restart all your instances of RStudio. There are hooks into the graphical user interface, so you need a FULL restart. Expect problems if you just try to restart R.

---
# Add a Splash of .blue[`rUM`]

+ .blue[`rUM`] has a bunch of .red[headers] that include YAML and setup instructions. A header is setup code that "always" appears at the top of a program.

.pull-left[
1)  From the RStudio file menu, choose R Markdown...

![:scale 100%](images/02_examples/file_rmarkdown.jpg)
]
.pull-right[
2) Choose From Template and then choose "html2 with rUM":

![:scale 70%](images/02_examples/templates.jpg)
]

---

.scroll-box-18[
![:scale 90%](images/02_examples/html2.jpg)
]

---
# Make a .blue[`rUM`] Infused Project

.pull-left-36[
![:scale 70%](images/02_examples/create_rum.jpg)
![:scale 70%](images/02_examples/type_rum.jpg)
]

.pull-right-60[
![:scale 40%](images/02_examples/template_rum.jpg)


```r
rUM::make_project(
  path,
  type = c("Quarto (analysis.qmd)", "R Markdown (analysis.Rmd)")
)
```
]

---

![:scale 100%](images/02_examples/new_rum.jpg)


---
.pull-left[
### R Markdown
![:scale 90%](images/02_examples/rmd_vs_quarto1.jpg)
]

.pull-right[
### Quarto
![:scale 90%](images/02_examples/rmd_vs_quarto2.jpg)
]

---
# The Default Ouput

.center[
![:scale 50%](images/02_examples/default.jpg)
]

---
# Visual Editor to Do Stuff

.pull-left[
+ point-and-click formatting
+ basic tables
+ images 
+ add references/citations

In the Visual Editor, typing .red[⌘ /] on Mac or .red[cmd /] on Linux/Windows is very useful.

]
.pull-right[
.center[
![:scale 100%](images/02_examples/visual.jpg)
]
]

---
# The Bibliography

+ The bibliography section of the template has code to find the packages used in the R Markdown or Quarto file and add them to the "packages.bib" file.


```
# automatically create a bib database for loaded R packages &amp; rUM
knitr::write_bib(
  c(
    .packages(),
    "rUM",
    "table1"
  ),
  "packages.bib"
)
```

---
# Use Package

+ Say you add .blue[`library(tidymodels)`] to your analysis file.
+ After you "knit" or "render" once, the package details will be added to the "packages.bib" file.  

.center[
![:scale 30%](images/02_examples/bib_tidymodels.jpg)
]

---
class: hide-slide-number

# Reference It

+ You can copy and paste the reference examples that are in the *Methods* (or point and click) to add it to the text in your methods section.

.pull-left[
![:scale 80%](images/02_examples/just_ref.jpg)

![:scale 90%](images/02_examples/methods.jpg)

]

.pull-right[
![:scale 90%](images/02_examples/methods_ref.jpg)
]

---
# Reference Style

By default, the style is set to be New England Journal of Medicine.  That is controlled by one line in the YAML header 

```
csl: the-new-england-journal-of-medicine.csl
```

and a details file that you can get from here: https://www.zotero.org/styles
.center[
![:scale 50%](images/02_examples/csl.jpg)
]
Save the CSL file into the project directory and tweak the YAML.

---
# .gitignore 

+ I teach workflows that use git and GitHub to students in the medical school.  So `rUM` infused projects include my very aggressive **.gitignore** file.  It attempts to block common dataset formats (Excel, Python, R, SAS, SPSS, STATA, text, and zip files). Take a look and tell me if I am missing anything.

.scroll-box-18[
```
# Version 2022-08-12

# History files
.Rhistory
.Rapp.history

# Session Data files
.RData
*.RData

# User-specific files
.Ruserdata

# Example code in package build process
*-Ex.R

# Output files from R CMD build
/*.tar.gz

# Output files from R CMD check
/*.Rcheck/

# RStudio files
.Rproj.user
.Rproj.user/

# produced vignettes
vignettes/*.html
vignettes/*.pdf

# OAuth2 token, see https://github.com/hadley/httr/releases/tag/v0.3
.httr-oauth

# knitr and R markdown default cache directories
*_cache/
/cache/

# Temporary files created by R markdown
*.utf8.md
*.knit.md

# R Environment Variables
.Renviron

# Mac
.DS_Store
.Thumbs.db
Thumbs.db

# R projects 
*.Rproj

# Directories
docs/
data/
development/
macros/
output/
sasdata/
libs/

# Exclude .Rmd output
*.html
**/figure-html/

# Exclude Text
*.txt
*.Txt
*.TXT

# Exclude Excel
*.xlsx
*.xls

# R data
*.rds
*.RDS
*.Rds
*.rda
*.RDA
*.Rda

# csv data
*.csv
*.CSV
*.Csv

# sas data
*.sas7bdat
*.sas7bcat

# SPSS data
*.sav
*.SAV
*.Sav

# SPSS output
*.spv
*.SPV
*.Spv

# STATA data
*.dta
*.DTA
*.Dta

# STATA log files
*.log
*.LOG
*.Log
*.smcl
*.SMCL
*.Smcl

# data commonly used in Python
*.json
*.pkl
*.h5
*.msgpack
*.parquet
*.feather

# VSC
www/.vscode/

# Bookdown book
_book/
_bookdown_files/

# Binary - Powerpoint and iThoughtsX
*.ppt
*.pptx
*.itmz

# R packages
*.tar

# Archives
*.zip
*.Zip
*.ZIP

# Quarto
/.quarto/
/_site/
.quarto/
_site/
```
]

---
class: segue

REDCap R Packages/Tools

---
# Summary of REDCap Processing Packages - History

+ Info was current on May 29th, 2023.

&lt;table&gt;
 &lt;thead&gt;
  &lt;tr&gt;
   &lt;th style="text-align:left;"&gt;   &lt;/th&gt;
   &lt;th style="text-align:left;"&gt; REDCapExporter &lt;/th&gt;
   &lt;th style="text-align:left;"&gt; tidyREDCap &lt;/th&gt;
   &lt;th style="text-align:left;"&gt; REDCapTidieR &lt;/th&gt;
   &lt;th style="text-align:left;"&gt; REDCapDM &lt;/th&gt;
  &lt;/tr&gt;
 &lt;/thead&gt;
&lt;tbody&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; CRAN Downloads &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; 15,840 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; 15,207 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; 2,390 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; 1,618 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; First CRAN Release &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; 2019-12-22 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; 2020-01-14 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; 2022-09-21 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; 2022-12-22 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; Latest CRAN Release Date &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; 2021-02-02 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; 2023-05-29 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; 2023-05-18 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; 2023-03-31 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; Latest GitHub Update Date &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; 2021-03-05 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; 2023-05-29 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; 2023-05-26 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; 2023-03-31 &lt;/td&gt;
  &lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;


---
class: hide-slide-number

# Summary of REDCap Processing Packages

.smaller[
&lt;table class="table" style="width: auto !important; margin-left: auto; margin-right: auto;"&gt;
 &lt;thead&gt;
  &lt;tr&gt;
   &lt;th style="text-align:left;"&gt; Feature &lt;/th&gt;
   &lt;th style="text-align:left;"&gt; REDCapExporter &lt;/th&gt;
   &lt;th style="text-align:left;"&gt; tidyREDCap &lt;/th&gt;
   &lt;th style="text-align:left;"&gt; REDCapTidieR &lt;/th&gt;
   &lt;th style="text-align:left;"&gt; REDCapDM &lt;/th&gt;
  &lt;/tr&gt;
 &lt;/thead&gt;
&lt;tbody&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; API Export Project into a R package &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; ✅ &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; ❌ &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; ❌ &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; ❌ &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; Manually Export and Load into R &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; ❌ &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; ✅ &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; ❌ &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; ✅ &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; API Export a Single Table &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; ❌ &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; ✅ &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; ❌ &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; ❌ &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; API Export All Tables &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; ❌ &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; ✅ &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; ✅ &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; ✅ &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; Use/Show Field Labels &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; ❌ &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; ✅ &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; ✅ &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; ✅ &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; Summary Tables Choose One Questions &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; ❌ &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; ✅ &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; ❌ &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; ❌ &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; Summary Tables Choose All Questions &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; ❌ &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; ✅ &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; ❌ &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; ❌ &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; Convert Checked/Unchecked to Yes/No Yes/No/Unknown &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; ❌ &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; ✅ &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; ❌ &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; ❌ &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; Tools for Querying Logical Expressions &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; ❌ &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; ❌ &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; ❌ &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; ✅ &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; Tools for Counting Longitudinal Events &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; ❌ &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; ❌ &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; ❌ &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; ✅ &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; Recalcualte Calculated Fields &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; ❌ &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; ❌ &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; ❌ &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; ✅ &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; Split Data by Event/Form &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; ❌ &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; ❌ &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; ❌ &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; ✅ &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; Summarize Metadata &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; ❌ &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; ❌ &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; ✅ &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; ❌ &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; Convert to Excel &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; ❌ &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; ❌ &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; ✅ &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; ❌ &lt;/td&gt;
  &lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
]

---
# One Package to Rule Them All - .blue[`REDCapR`]

+ .blue[`REDCapR`] - Has all the functionality to push and pull all kinds of data into and out of REDCap.

---
class: segue

REDCap Processing with `tidyREDCap`

---
# What .blue[`tidyREDCap`] Does

1. Easy imports into R from REDCap
  + [import_instruments()](https://raymondbalise.github.io/tidyREDCap/articles/import_instruments.html0) imports all data with labels (i.e., the text that appears on the survey page).
2. Summarize categorical variables
  + [make_choose_one_table()](https://raymondbalise.github.io/tidyREDCap/articles/makeChooseOneTable.html) makes a summary of a choose-one question.
  + [make_choose_all_table()](https://raymondbalise.github.io/tidyREDCap/articles/makeChooseAllTable.html) shows counts of all the options chosen from choose-all questions.
  + [make_binary_word()](https://raymondbalise.github.io/tidyREDCap/reference/make_binary_word.html) shows response patterns from choose-all questions.
&lt;br&gt;  
.center[[https://raymondbalise.github.io/tidyREDCap/](https://raymondbalise.github.io/tidyREDCap/)]

---
# Import Everything with .blue[`tidyREDCap:import_instruments()`]

+ .blue[`tidyREDCap`] allows you to pull in all the instruments by adding a .blue[`tidyREDCap::import_instruments()`] call.  All you need is the .red[URL] for your copy of REDCap and your .red[API] token.
+ .red[Do not save your API token in your code.]  It is way too easy to accidentally give away your password.
+ There are good options to securely store your API keys.  If you work on an secure/encrypted machine, a fair alternative is to store your API keys in your *R environment* file. I use: .blue[`usethis::edit_r_environ()`]
    
---
# Store Your API Token

+ Copy the token (password text) from REDCap.

.center[
![:scale 50%](images/02_examples/idea_token.jpg)
]

+ Open your R environment file with .blue[`usethis::edit_r_environ()`] and give your token a meaningful name. Use an `=` and quote the string.
.center[
![:scale 50%](images/02_examples/idea_r_environ.jpg)
]

---
# Add Code to Load

+ Typically you would just do:


```r
tidyREDCap::import_instruments(
  "https://redcap.miami.edu/api/", 
  Sys.getenv("nacho_anxiety_key") 
)
```

+ Because this project uses a custom subject ID name and numbering, do:


```r
tidyREDCap::import_instruments(
  url = "https://redcapdemo.vanderbilt.edu/api/", 
  token = Sys.getenv("IDEA_R_Medicine_2023_Clone"), 
  record_id= "id_code", first_record_id = "07"
)
```





---
# What could possibly go wrong?

If you see:

.red[
```
Error in REDCapR::redcap_metadata_read(redcap_uri = url, token = token) : 
  Assertion on 'token' failed: Must comply to pattern '^.{1,}$'.
```
]

`tidyREDCap` can't find the name of the API key in your .Renviron file.  Check for inconsistency (a typo) between the two places where the name is typed.

.red[
```
Error in sanitize_token(token) : 
  The token is not a valid 32-character hexademical value.
```
]

The API key is invalid.  Try to copy and paste it again. **_Restart R_**.

.red[
```
Error in \`pull()`:
! \`!!enquo(var)` must select exactly one column.
Run \`rlang::last_error()` to see where the error occurred.
```
]

The API key is not associated with a REDCap project.  Try to copy and paste it again. **_Restart R_**.

---
# Loaded Data


.center[
![:scale 50%](images/02_examples/idea_environment.jpg)

]

* The data is imported and the variables have labels:

.pull-left[
![:scale 100%](images/02_examples/idea_enrollment_tib.jpg)
]
.pull-right[
![:scale 100%](images/02_examples/idea_daily_tib.jpg)
]

---
# The Origin of .blue[`tidyREDCap`]

+ Novices could not process the export of choose-all-that-apply questions.
  + For example,the export has a column for Carfentanil, Cocaine, Crack, etc.
+ How do we get the count of all the chosen things?
+ How can we look at co-occurring patterns?
.center[
![:scale 80%](images/02_examples/view_iv_drugs.jpg)
]


---
# .blue[`make_choose_one_table()`]


```r
library(tidyREDCap)
enrollment |&gt; 
    make_choose_one_table(injection_drugs___1) |&gt; 
    knitr::kable()
```

```
## In the past 30 days, which injection drugs have you used?: Carfentanil
```

&lt;table&gt;
 &lt;thead&gt;
  &lt;tr&gt;
   &lt;th style="text-align:left;"&gt; Response &lt;/th&gt;
   &lt;th style="text-align:right;"&gt; n &lt;/th&gt;
   &lt;th style="text-align:left;"&gt; percent &lt;/th&gt;
  &lt;/tr&gt;
 &lt;/thead&gt;
&lt;tbody&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; Checked &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 1 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; 3% &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; Unchecked &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 33 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; 97% &lt;/td&gt;
  &lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;

---
# .blue[`make_choose_all_table()`]

.pull-left[
+ Merge all the choices into a single column and do a count:


```r
library(tidyREDCap)
enrollment |&gt; 
  make_choose_all_table("injection_drugs__") |&gt; 
  knitr::kable()
```
]

.pull-right[
.center[
.scroll-box-16[
&lt;table&gt;
 &lt;thead&gt;
  &lt;tr&gt;
   &lt;th style="text-align:left;"&gt; What &lt;/th&gt;
   &lt;th style="text-align:right;"&gt; Count &lt;/th&gt;
  &lt;/tr&gt;
 &lt;/thead&gt;
&lt;tbody&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; Carfentanil &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 1 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; Cocaine &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 5 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; Crack &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 2 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; Fentanyl &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 9 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; Heroin &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 12 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; Hormones &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; Methamphetamine &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 6 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; Pain Killers &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; Prescription Opioids &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 1 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; Speedball &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 9 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; Steroids &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; Tranquilizers &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 2 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; Other non-prescription &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 1 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; Some other prescription medication &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; None &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 3 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; Refused or dont know &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 1 &lt;/td&gt;
  &lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
]]]

---
# .blue[`make_binary_word()`] `\(_1\)`

.pull-left[
.small[
+ Use _ or a letter to show co-occurring patterns:


| Var | Abbreviation | Drug                 |
| :-- | :----------  | :------------------- |
| 1   | R            | Carfentanil          |
| 2   | C            | Cocaine              |
| 3   | K            | Crack                |
| 4   | F            | Fentanyl             |
| 5   | H            | Heroin               |
| 7   | M            | Methamphetamine      |
| 8   | P            | Pain Killers         |
| 9   | O            | Prescription Opioids |
| 10  | S            | Speedball            |

]]

.pull-right[
.smaller[
&lt;table&gt;
 &lt;thead&gt;
  &lt;tr&gt;
   &lt;th style="text-align:left;"&gt; pattern &lt;/th&gt;
   &lt;th style="text-align:right;"&gt; n &lt;/th&gt;
   &lt;th style="text-align:left;"&gt; percent &lt;/th&gt;
  &lt;/tr&gt;
 &lt;/thead&gt;
&lt;tbody&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; R________ &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 1 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; 2.94% &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; _C_F____S &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 1 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; 2.94% &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; _C_F_____ &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 1 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; 2.94% &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; _C__HM__S &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 1 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; 2.94% &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; _C__H__OS &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 1 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; 2.94% &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; _C___M___ &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 1 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; 2.94% &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; __K______ &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 2 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; 5.88% &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; ___F_M__S &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 1 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; 2.94% &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; ___F_____ &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 6 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; 17.65% &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; ____H___S &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 4 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; 11.76% &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; ____H____ &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 6 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; 17.65% &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; _____M___ &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 3 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; 8.82% &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; ________S &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 1 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; 2.94% &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; _________ &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 5 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; 14.71% &lt;/td&gt;
  &lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
]]

---
# .blue[`make_binary_word()`] `\(_2\)`
.pull-left-60[

```r
suppressPackageStartupMessages(library(tidyverse))

labels &lt;- 
  c("R", "C", "K", "F", "H", "M", "P", "O", "S")

pattern &lt;- 
  enrollment |&gt; 
  select(
    injection_drugs___1:injection_drugs___5, 
    injection_drugs___7:injection_drugs___10
  ) |&gt; 
  make_binary_word(the_labels = labels)

janitor::tabyl(pattern) |&gt; 
  janitor::adorn_pct_formatting(digits =2) |&gt; 
  knitr::kable()
```
]
.pull-right-36[
.center[
.smaller[
&lt;table&gt;
 &lt;thead&gt;
  &lt;tr&gt;
   &lt;th style="text-align:left;"&gt; pattern &lt;/th&gt;
   &lt;th style="text-align:right;"&gt; n &lt;/th&gt;
   &lt;th style="text-align:left;"&gt; percent &lt;/th&gt;
  &lt;/tr&gt;
 &lt;/thead&gt;
&lt;tbody&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; R________ &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 1 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; 2.94% &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; _C_F____S &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 1 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; 2.94% &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; _C_F_____ &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 1 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; 2.94% &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; _C__HM__S &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 1 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; 2.94% &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; _C__H__OS &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 1 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; 2.94% &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; _C___M___ &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 1 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; 2.94% &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; __K______ &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 2 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; 5.88% &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; ___F_M__S &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 1 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; 2.94% &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; ___F_____ &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 6 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; 17.65% &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; ____H___S &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 4 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; 11.76% &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; ____H____ &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 6 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; 17.65% &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; _____M___ &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 3 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; 8.82% &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; ________S &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 1 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; 2.94% &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; _________ &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 5 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; 14.71% &lt;/td&gt;
  &lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
]]]

---
# But wait there is more!

+ .blue[`tidyREDCap`] also has tools for converting checked/unchecked/unknown into yes/no responses.


```r
library(tidyREDCap)
make_yes_no(enrollment$injection_drugs___1) |&gt; 
  tidyREDCap::make_choose_one_table()
```

 

```
##       Response  n percent
##  No or Unknown 33     97%
##            Yes  1      3%
```


```r
make_yes_no_unknown(enrollment$injection_drugs___1) |&gt; 
  tidyREDCap::make_choose_one_table()
```

 

```
##  Response  n percent
##        No 33     97%
##       Yes  1      3%
##   Unknown  0      0%
```

---
# Thank you!
.smaller[
.pull-left[
+ IDEA
  + Hansel Tookes, MD MPH, University of Miami
  + Tyler Bartholomew, PhD, University of Miami 
  + Belen del Sol Hervera, MPH, University of Miami
+ .blue[`rUM`]
  + Gabriel Odom, PhD, Florida International University 
  + Kyle Grealis, MS, University of Miami
  + Francisco Cardoza, (almost PhD) University of Miami
  + Frank Gutierrez, MS, University of Miami
]
.pull-right[
+ .blue[`tidyREDCap`]
  + Gabriel Odom, PhD, Florida International University 
  + Anna Calderon, MS, University of Miami
  + Layla Bouzoubaa, MSPH, Drexel University
  + Wayne DeFreitas, MS,  University of Miami
  + Lauren Nahodyl, MS, University of Miami
  + Lionel Henry, Posit
  + Davis Vaughan, Posit
  
+ All of this work
  + Daniel Feaster, PhD, University of Miami
  + The R and R/Medicine community
]]

---
# Funding That Made This Work Possible

+ Healing Communities Study: Developing and Testing an Integrated Approach to Address the Opioid Crisis-New York State. National Institute on Drug Abuse, 1 UM1 DA049415
+ CTN-0094 Individual Level Predictive Modeling of Opioid Use Disorder Treatment Outcome. Florida Node Alliance of The Drug Abuse Clinical Trials Network (NIDA) UG1 DA013720
+ University of Miami Center for HIV and Researching Mental Health (CHARM) NIH 1P30MH116867-01A1
+ University of Miami, Sylvester Comprehensive Cancer Center
+ Florida International University, Stempel College of Public Health  

---
# But wait there is even more!

The developers of .blue[`REDCapTidieR`] gives your REDCap projects super(tibble) powers and .blue[`REDCapDM`] gives you tailored data management/checking tools.


---
# ... and there is still more!

The ultimate power, including loading your data into REDCap, is at your fingertips with the .blue[`REDCapR`] package.
    </textarea>
<style data-target="print-only">@media screen {.remark-slide-container{display:block;}.remark-slide-scaler{box-shadow:none;}}</style>
<script src="https://remarkjs.com/downloads/remark-latest.min.js"></script>
<script src="assets/macros.js"></script>
<script>var slideshow = remark.create({
"highlightStyle": "github",
"highlightLines": false,
"highlightSpans": true,
"countIncrementalSlides": false,
"ratio": "16:9",
"navigation": {
"scroll": false
}
});
if (window.HTMLWidgets) slideshow.on('afterShowSlide', function (slide) {
  window.dispatchEvent(new Event('resize'));
});
(function(d) {
  var s = d.createElement("style"), r = d.querySelector(".remark-slide-scaler");
  if (!r) return;
  s.type = "text/css"; s.innerHTML = "@page {size: " + r.style.width + " " + r.style.height +"; }";
  d.head.appendChild(s);
})(document);

(function(d) {
  var el = d.getElementsByClassName("remark-slides-area");
  if (!el) return;
  var slide, slides = slideshow.getSlides(), els = el[0].children;
  for (var i = 1; i < slides.length; i++) {
    slide = slides[i];
    if (slide.properties.continued === "true" || slide.properties.count === "false") {
      els[i - 1].className += ' has-continuation';
    }
  }
  var s = d.createElement("style");
  s.type = "text/css"; s.innerHTML = "@media print { .has-continuation { display: none; } }";
  d.head.appendChild(s);
})(document);
// delete the temporary CSS (for displaying all slides initially) when the user
// starts to view slides
(function() {
  var deleted = false;
  slideshow.on('beforeShowSlide', function(slide) {
    if (deleted) return;
    var sheets = document.styleSheets, node;
    for (var i = 0; i < sheets.length; i++) {
      node = sheets[i].ownerNode;
      if (node.dataset["target"] !== "print-only") continue;
      node.parentNode.removeChild(node);
    }
    deleted = true;
  });
})();
// add `data-at-shortcutkeys` attribute to <body> to resolve conflicts with JAWS
// screen reader (see PR #262)
(function(d) {
  let res = {};
  d.querySelectorAll('.remark-help-content table tr').forEach(tr => {
    const t = tr.querySelector('td:nth-child(2)').innerText;
    tr.querySelectorAll('td:first-child .key').forEach(key => {
      const k = key.innerText;
      if (/^[a-z]$/.test(k)) res[k] = t;  // must be a single letter (key)
    });
  });
  d.body.setAttribute('data-at-shortcutkeys', JSON.stringify(res));
})(document);
(function() {
  "use strict"
  // Replace <script> tags in slides area to make them executable
  var scripts = document.querySelectorAll(
    '.remark-slides-area .remark-slide-container script'
  );
  if (!scripts.length) return;
  for (var i = 0; i < scripts.length; i++) {
    var s = document.createElement('script');
    var code = document.createTextNode(scripts[i].textContent);
    s.appendChild(code);
    var scriptAttrs = scripts[i].attributes;
    for (var j = 0; j < scriptAttrs.length; j++) {
      s.setAttribute(scriptAttrs[j].name, scriptAttrs[j].value);
    }
    scripts[i].parentElement.replaceChild(s, scripts[i]);
  }
})();
(function() {
  var links = document.getElementsByTagName('a');
  for (var i = 0; i < links.length; i++) {
    if (/^(https?:)?\/\//.test(links[i].getAttribute('href'))) {
      links[i].target = '_blank';
    }
  }
})();</script>

<script>
slideshow._releaseMath = function(el) {
  var i, text, code, codes = el.getElementsByTagName('code');
  for (i = 0; i < codes.length;) {
    code = codes[i];
    if (code.parentNode.tagName !== 'PRE' && code.childElementCount === 0) {
      text = code.textContent;
      if (/^\\\((.|\s)+\\\)$/.test(text) || /^\\\[(.|\s)+\\\]$/.test(text) ||
          /^\$\$(.|\s)+\$\$$/.test(text) ||
          /^\\begin\{([^}]+)\}(.|\s)+\\end\{[^}]+\}$/.test(text)) {
        code.outerHTML = code.innerHTML;  // remove <code></code>
        continue;
      }
    }
    i++;
  }
};
slideshow._releaseMath(document);
</script>
<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
(function () {
  var script = document.createElement('script');
  script.type = 'text/javascript';
  script.src  = 'https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML';
  if (location.protocol !== 'file:' && /^https?:/.test(script.src))
    script.src  = script.src.replace(/^https?:/, '');
  document.getElementsByTagName('head')[0].appendChild(script);
})();
</script>
  </body>
</html>
